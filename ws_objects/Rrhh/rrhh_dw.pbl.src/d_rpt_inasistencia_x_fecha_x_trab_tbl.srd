$PBExportHeader$d_rpt_inasistencia_x_fecha_x_trab_tbl.srd
release 9;
datawindow(units=0 timer_interval=0 color=16777215 processing=0 HTMLDW=no print.printername="" print.documentname="" print.orientation = 0 print.margin.left = 110 print.margin.right = 110 print.margin.top = 96 print.margin.bottom = 96 print.paper.source = 0 print.paper.size = 9 print.canusedefaultprinter=yes print.prompt=no print.buttons=no print.preview.buttons=no print.cliptext=no print.overrideprintjob=no print.collate=yes hidegrayline=no )
header(height=720 color="536870912" )
summary(height=200 color="536870912" )
footer(height=0 color="536870912" )
detail(height=72 color="536870912" )
table(column=(type=char(8) updatewhereclause=yes name=cod_trabajador dbname="inasistencia.cod_trabajador" )
 column=(type=char(30) updatewhereclause=yes name=apel_paterno dbname="maestro.apel_paterno" )
 column=(type=char(30) updatewhereclause=yes name=apel_materno dbname="maestro.apel_materno" )
 column=(type=char(30) updatewhereclause=yes name=nombre1 dbname="maestro.nombre1" )
 column=(type=char(30) updatewhereclause=yes name=nombre2 dbname="maestro.nombre2" )
 column=(type=char(4) updatewhereclause=yes name=concep dbname="inasistencia.concep" )
 column=(type=char(25) updatewhereclause=yes name=dec_concep dbname="dec_concep" )
 column=(type=datetime updatewhereclause=yes name=fec_desde dbname="inasistencia.fec_desde" )
 column=(type=datetime updatewhereclause=yes name=fec_hasta dbname="inasistencia.fec_hasta" )
 column=(type=number updatewhereclause=yes name=dias_inasist dbname="inasistencia.dias_inasist" )
 column=(type=datetime updatewhereclause=yes name=inasistencia_fec_movim dbname="inasistencia.fec_movim" )
 column=(type=char(2) updatewhereclause=yes name=cod_origen dbname="maestro.cod_origen" )
 column=(type=char(50) updatewhereclause=yes name=desc_origen dbname="desc_origen" )
 column=(type=char(3) updatewhereclause=yes name=tipo_trabajador dbname="maestro.tipo_trabajador" )
 column=(type=char(30) updatewhereclause=yes name=desc_tipo_tra dbname="desc_tipo_tra" )
 column=(type=char(3) updatewhereclause=yes name=cod_seccion dbname="maestro.cod_seccion" )
 column=(type=char(30) updatewhereclause=yes name=desc_seccion dbname="desc_seccion" )
 column=(type=char(6) updatewhereclause=yes name=semana dbname="semana" )
 column=(type=char(6) updatewhereclause=yes name=cod_usr dbname="inasistencia.cod_usr" )
 retrieve="select i.cod_trabajador, m.apel_paterno, m.apel_materno, m.nombre1, m.nombre2, i.concep, initcap(c.desc_breve) as dec_concep, i.fec_desde, i.fec_hasta, i.dias_inasist, i.fec_movim, m.cod_origen, initcap(o.nombre) as desc_origen, m.tipo_trabajador, initcap(tt.desc_tipo_tra) as desc_tipo_tra, m.cod_seccion, initcap(s.desc_seccion) as desc_seccion, lpad(to_char(cld.ano_calc),4,'0') || lpad(to_char(cld.semana_calc),2,'0') as semana, i.cod_usr
  from inasistencia i,concepto c,maestro m,origen o,tipo_trabajador tt,seccion s,calendario cld
 where (i.cod_trabajador   = m.cod_trabajador   ) and
       (i.concep           = c.concep           ) and
       (m.cod_origen       = o.cod_origen       ) and
       (m.tipo_trabajador  = tt.tipo_trabajador ) and
       (m.cod_area         = s.cod_area      (+)) and
       (m.cod_seccion      = s.cod_seccion   (+)) and
       (trunc(i.fec_movim) = trunc(cld.fecha)   ) and
       (m.cod_origen       in (select oao.cod_origen 
                                from ot_adm_origen oao,ot_adm_usuario oau 
                               where (oao.ot_adm = oau.ot_adm) and
                                     (oau.cod_usr = :as_cod_usr ) )) and
		 (m.cod_origen			like :as_cod_origen		)	and
		 (m.tipo_trabajador  like :as_ttrab				)	and
		 (trunc(i.fec_movim) between trunc(:ad_fec_desde) and trunc(:ad_fec_hasta) )
                                     
union all
select hi.cod_trabajador, m.apel_paterno, m.apel_materno, m.nombre1, m.nombre2, hi.concep, initcap(c.desc_breve) as dec_concep, hi.fec_desde, hi.fec_hasta, hi.dias_inasist, hi.fec_movim, m.cod_origen, initcap(o.nombre) as desc_origen, m.tipo_trabajador, initcap(tt.desc_tipo_tra) as desc_tipo_tra, m.cod_seccion, initcap(s.desc_seccion) as desc_seccion, lpad(to_char(cld.ano_calc),4,'0') || lpad(to_char(cld.semana_calc),2,'0') as semana, hi.cod_usr
  from historico_inasistencia hi ,concepto c,maestro m,origen o,tipo_trabajador tt,seccion s,calendario cld
 where (hi.concep           = c.concep           ) and
       (hi.cod_trabajador   = m.cod_trabajador   ) and
       (m.cod_area          = s.cod_area      (+)) and
       (m.cod_seccion       = s.cod_seccion      ) and
       (m.cod_origen        = o.cod_origen       ) and
       (m.tipo_trabajador   = tt.tipo_trabajador ) and
       (trunc(hi.fec_movim) = trunc(cld.fecha)   ) and
       ( m.cod_origen in (select oao.cod_origen 
                           from ot_adm_origen oao,ot_adm_usuario oau 
                          where (oao.ot_adm  = oau.ot_adm ) and
                                (oau.cod_usr = :as_cod_usr   ))) and
		 (m.cod_origen			like :as_cod_origen		)	and
		 (m.tipo_trabajador  like :as_ttrab				)	and
		 (trunc(hi.fec_movim) between trunc(:ad_fec_desde) and trunc(:ad_fec_hasta) )
order by cod_origen, tipo_trabajador, apel_paterno, apel_materno, nombre1, nombre2, fec_desde, concep

" arguments=(("as_cod_usr", string),("as_cod_origen", string),("as_ttrab", string),("ad_fec_desde", date),("ad_fec_hasta", date)) )
group(level=1 header.height=0 trailer.height=76 by=("cod_origen" , "tipo_trabajador" ) newpage=yes header.color="536870912" trailer.color="536870912" )
group(level=2 header.height=76 trailer.height=68 by=("cod_trabajador" ) header.color="536870912" trailer.color="536870912" )
text(band=header alignment="2" text="CONSISTENCIA DE INASISTENCIAS POR TRABAJADOR" border="0" color="0" x="608" y="80" height="80" width="2043" html.valueishtml="0"  name=st_titulo visible="1"  font.face="Century Gothic" font.height="-12" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215"  height.autosize=yes)
text(band=header alignment="2" text="" border="0" color="0" x="978" y="192" height="56" width="1349" html.valueishtml="0"  name=st_rango_fecha visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
compute(band=header alignment="1" expression="'Página ' + page() + ' de ' + pageCount()"border="0" color="0" x="2715" y="92" height="56" width="535" format="[general]" html.valueishtml="0"  name=compute_1 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
text(band=header alignment="2" text="Origen" border="2" color="0" x="622" y="496" height="56" width="206" html.valueishtml="0"  name=t_7 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=header id=13 alignment="2" tabsequence=32766 border="2" color="16711680" x="832" y="496" height="56" width="613" format="[general]" html.valueishtml="0"  name=desc_origen visible="1" edit.limit=0 edit.case=any edit.autoselect=yes edit.imemode=0  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=header id=15 alignment="2" tabsequence=32766 border="2" color="16711680" x="1769" y="496" height="56" width="512" format="[general]" html.valueishtml="0"  name=desc_tipo_tra visible="1" edit.limit=0 edit.case=any edit.autoselect=yes edit.imemode=0  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
text(band=header alignment="2" text="Trabajador" border="2" color="0" x="1449" y="496" height="56" width="315" html.valueishtml="0"  name=t_10 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
text(band=header alignment="2" text="Semana" border="2" color="0" x="2286" y="496" height="56" width="247" html.valueishtml="0"  name=dias_inasist_t visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=header id=18 alignment="2" tabsequence=32766 border="2" color="16711680" x="2537" y="496" height="56" width="133" format="[general]" html.valueishtml="0"  name=semana visible="1" edit.limit=0 edit.case=any edit.autoselect=yes edit.imemode=0  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
text(band=header alignment="2" text="Nro." border="2" color="0" x="2057" y="596" height="56" width="197" html.valueishtml="0"  name=t_16 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="15780518" )
text(band=header alignment="2" text="Fecha" border="2" color="0" x="1445" y="596" height="56" width="608" html.valueishtml="0"  name=t_13 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="15780518" )
text(band=header alignment="2" text="Código" border="2" color="0" x="2258" y="596" height="56" width="187" html.valueishtml="0"  name=t_1 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="15780518" )
text(band=header alignment="2" text="Concepto" border="2" color="0" x="498" y="596" height="56" width="942" html.valueishtml="0"  name=t_6 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="15780518" )
text(band=header alignment="2" text="Usuario" border="2" color="0" x="2258" y="656" height="56" width="187" html.valueishtml="0"  name=t_3 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="15780518" )
text(band=header alignment="2" text="Días" border="2" color="0" x="2057" y="656" height="56" width="197" html.valueishtml="0"  name=t_2 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="15780518" )
text(band=header alignment="2" text="Final" border="2" color="0" x="1751" y="656" height="56" width="302" html.valueishtml="0"  name=t_18 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="15780518" )
text(band=header alignment="2" text="Inicio" border="2" color="0" x="1445" y="656" height="56" width="302" html.valueishtml="0"  name=t_17 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="15780518" )
text(band=header alignment="2" text="Código" border="2" color="0" x="498" y="656" height="56" width="206" html.valueishtml="0"  name=t_5 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="15780518" )
text(band=header alignment="2" text="Nombre" border="2" color="0" x="709" y="656" height="56" width="731" html.valueishtml="0"  name=t_9 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="15780518" )
text(band=header alignment="2" text="Fecha Registro" border="2" color="0" x="55" y="596" height="116" width="439" html.valueishtml="0"  name=t_12 visible="1"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="15780518" )
compute(band=header alignment="2" expression="' Desde : ' + String(  ad_fec_desde  ,'dd/mm/yyyy') +'   Hasta : ' +String(  ad_fec_hasta  ,'dd/mm/yyyy')"border="0" color="0" x="933" y="280" height="76" width="1417" format="[GENERAL]" html.valueishtml="0"  name=compute_6 visible="1"  font.face="Arial" font.height="-12" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
text(band=header alignment="1" text="Fecha :" border="0" color="0" x="2706" y="172" height="56" width="233" html.valueishtml="0"  name=t_11 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
text(band=header alignment="1" text="Usuario :" border="0" color="0" x="2706" y="240" height="56" width="233" html.valueishtml="0"  name=t_8 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
compute(band=header alignment="0" expression="today()"border="0" color="0" x="2967" y="172" height="56" width="288" format="[general]" html.valueishtml="0"  name=date_1 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
text(band=header alignment="0" text="" border="0" color="0" x="2967" y="240" height="56" width="288" html.valueishtml="0"  name=t_user visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
bitmap(band=header filename="H:\Source\BMP\blanco.bmp" x="50" y="48" height="172" width="366" border="0"  name=p_logo visible="1" )
text(band=header alignment="2" text="" border="0" color="0" x="50" y="252" height="56" width="366" html.valueishtml="0"  name=t_nombre visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
compute(band=header.2 alignment="0" expression="if(isNull( apel_paterno ), ' ',  trim(apel_paterno) ) + ' ' +  if(isNull(  apel_materno  ), ' ',  trim( apel_materno ) ) + ' ' + if(isNull(  nombre1 ), ' ',  trim( nombre1 ) ) + ' ' + if(isNull(  nombre2  ), ' ',  trim( nombre2 ) )"border="0" color="0" x="343" y="16" height="56" width="1362" format="[GENERAL]" html.valueishtml="0"  name=nombre_trabajador visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=header.2 id=1 alignment="0" tabsequence=32766 border="0" color="0" x="50" y="16" height="56" width="274" format="[general]" html.valueishtml="0"  name=cod_trabajador visible="1" edit.limit=0 edit.case=any edit.autoselect=yes edit.imemode=0  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=detail id=11 alignment="0" tabsequence=32766 border="0" color="0" x="55" y="4" height="56" width="439" format="[shortdate] [time]" html.valueishtml="0"  name=inasistencia_fec_movim visible="1" editmask.mask="dd/mm/yyyy" editmask.imemode=0 editmask.focusrectangle=no  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=detail id=19 alignment="2" tabsequence=32766 border="0" color="0" x="2258" y="4" height="56" width="187" format="[general]" html.valueishtml="0"  name=cod_usr visible="1" edit.limit=0 edit.case=any edit.autoselect=yes edit.imemode=0  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=detail id=9 alignment="2" tabsequence=32766 border="0" color="0" x="1751" y="4" height="56" width="302" format="[shortdate] [time]" html.valueishtml="0"  name=fec_hasta visible="1" editmask.mask="dd/mm/yyyy" editmask.imemode=0 editmask.focusrectangle=no  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=detail id=8 alignment="2" tabsequence=32766 border="0" color="0" x="1445" y="4" height="56" width="302" format="[shortdate] [time]" html.valueishtml="0"  name=fec_desde visible="1" editmask.mask="dd/mm/yyyy" editmask.imemode=0 editmask.focusrectangle=no  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=detail id=7 alignment="0" tabsequence=32766 border="0" color="0" x="709" y="4" height="56" width="731" format="[general]" html.valueishtml="0"  name=dec_concep visible="1" edit.limit=0 edit.case=any edit.autoselect=yes edit.imemode=0  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=detail id=6 alignment="2" tabsequence=32766 border="0" color="0" x="498" y="4" height="56" width="206" format="[general]" html.valueishtml="0"  name=concep visible="1" edit.limit=0 edit.case=any edit.autoselect=yes edit.imemode=0  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=detail id=10 alignment="1" tabsequence=32766 border="0" color="0" x="2057" y="4" height="56" width="197" format="[general]" html.valueishtml="0"  name=dias_inasist visible="1" editmask.mask="###,##0.00" editmask.imemode=0 editmask.focusrectangle=no  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
compute(band=trailer.2 alignment="1" expression="sum(dias_inasist for group 2)"border="0" color="0" x="1989" y="8" height="56" width="265" format="###,###,##0.00" html.valueishtml="0"  name=compute_2 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
text(band=trailer.2 alignment="1" text="Total por Trabajador :" border="0" color="0" x="1353" y="8" height="56" width="622" html.valueishtml="0"  name=t_4 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
compute(band=trailer.1 alignment="0" expression="'TOTAL  ' + UPPER(TRIM( desc_origen )) + '  -  ' + UPPER(TRIM(  desc_tipo_tra  ))"border="0" color="16711680" x="55" y="12" height="56" width="1893" format="[GENERAL]" html.valueishtml="0"  name=compute_3 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
compute(band=trailer.1 alignment="1" expression="sum(dias_inasist for group 1)"border="0" color="16711680" x="1989" y="12" height="56" width="265" format="###,###,##0.00" html.valueishtml="0"  name=compute_5 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
rectangle(band=summary x="50" y="48" height="108" width="3218"  name=r_2 visible="1" brush.hatch="6" brush.color="16777215" pen.style="0" pen.width="9" pen.color="0"  background.mode="2" background.color="0" )
text(band=summary alignment="2" text="TOTAL GENERAL" border="0" color="0" x="233" y="72" height="56" width="2528" html.valueishtml="0"  name=t_15 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
compute(band=summary alignment="1" expression="sum(dias_inasist for all)"border="0" color="33554432" x="2798" y="72" height="56" width="265" format="###,###,##0.00" html.valueishtml="0"  name=compute_4 visible="1"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
htmltable(border="1" )
htmlgen(clientevents="1" clientvalidation="1" clientcomputedfields="1" clientformatting="0" clientscriptable="0" generatejavascript="1" encodeselflinkargs="1" netscapelayers="0" )
export.xml(headgroups="1" includewhitespace="0" metadatatype=0 savemetadata=0 )
import.xml()
export.pdf(method=0 distill.custompostscript="0" xslfop.print="0" )
