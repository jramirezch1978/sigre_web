$PBExportHeader$u_tabpg_browse.sru
forward
global type u_tabpg_browse from u_base_tabpg
end type
type st_title from statictext within u_tabpg_browse
end type
type st_1 from statictext within u_tabpg_browse
end type
type sle_address from singlelineedit within u_tabpg_browse
end type
type ole_browser from u_web_browser within u_tabpg_browse
end type
end forward

global type u_tabpg_browse from u_base_tabpg
string text = "Browser"
st_title st_title
st_1 st_1
sle_address sle_address
ole_browser ole_browser
end type
global u_tabpg_browse u_tabpg_browse

type prototypes
Function long SHAutoComplete ( &
	ulong hwndEdit, &
	ulong dwFlags &
	) Library "shlwapi.dll"

end prototypes

type variables
Constant ULong SHACF_AUTOAPPEND_FORCE_OFF		= 2147483648
Constant ULong SHACF_AUTOAPPEND_FORCE_ON		= 1073741824
Constant ULong SHACF_AUTOSUGGEST_FORCE_OFF	= 536870912
Constant ULong SHACF_AUTOSUGGEST_FORCE_ON		= 268435456
Constant ULong SHACF_DEFAULT			= 0
Constant ULong SHACF_FILESYSTEM		= 1
Constant ULong SHACF_FILESYS_ONLY	= 16
Constant ULong SHACF_URLALL			= 6
Constant ULong SHACF_URLHISTORY		= 2
Constant ULong SHACF_URLMRU			= 4
Constant ULong SHACF_USETAB			= 8

end variables

forward prototypes
public subroutine of_settitletext (string as_text)
end prototypes

public subroutine of_settitletext (string as_text);st_title.text = " " + as_text

end subroutine

on u_tabpg_browse.create
int iCurrent
call super::create
this.st_title=create st_title
this.st_1=create st_1
this.sle_address=create sle_address
this.ole_browser=create ole_browser
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.st_title
this.Control[iCurrent+2]=this.st_1
this.Control[iCurrent+3]=this.sle_address
this.Control[iCurrent+4]=this.ole_browser
end on

on u_tabpg_browse.destroy
call super::destroy
destroy(this.st_title)
destroy(this.st_1)
destroy(this.sle_address)
destroy(this.ole_browser)
end on

event resize;call super::resize;st_title.Width    = this.Width - 74

sle_address.Width = this.Width - 294

ole_browser.of_Resize(this.Width  - 74, this.Height - 293)

end event

event open;call super::open;m_main lm_main

ole_browser.of_GoHome()

lm_main = iw_parent.MenuID

lm_main.mf_RegisterBrowse(this)

end event

event selectionchanged;call super::selectionchanged;sle_address.SetFocus()

end event

event m_pagesetup;call super::m_pagesetup;// display Page Setup window
ole_browser.of_execwb_PageSetup()

end event

event m_print;call super::m_print;// print with prompt
ole_browser.of_execwb_Print(True)

end event

event m_printpreview;call super::m_printpreview;// display Print Preview window
ole_browser.of_execwb_PrintPreview()

end event

type st_title from statictext within u_tabpg_browse
integer x = 37
integer y = 32
integer width = 2382
integer height = 80
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Trebuchet MS"
long textcolor = 134217737
long backcolor = 134217730
boolean focusrectangle = false
end type

type st_1 from statictext within u_tabpg_browse
integer x = 37
integer y = 140
integer width = 210
integer height = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Address:"
boolean focusrectangle = false
end type

type sle_address from singlelineedit within u_tabpg_browse
event keydown pbm_keydown
integer x = 256
integer y = 136
integer width = 2162
integer height = 80
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean autohscroll = false
borderstyle borderstyle = stylelowered!
end type

event keydown;// process enter key
If key = KeyEnter! Then
	ole_browser.of_Navigate(this.text)
End If

end event

event constructor;// turn on auto-complete
SHAutoComplete(Handle(this), SHACF_DEFAULT)

end event

type ole_browser from u_web_browser within u_tabpg_browse
integer x = 37
integer y = 256
integer width = 2382
integer height = 1316
integer taborder = 20
string binarykey = "u_tabpg_browse.udo"
end type

event statustextchange(string as_text);call super::statustextchange;w_main.SetMicroHelp(as_text)

end event

event titlechange(string as_text);call super::titlechange;Parent.of_SetTitleText(as_text)

end event

event navigatecomplete2(oleobject pdisp, any url);call super::navigatecomplete2;// update URL
sle_address.text = this.of_GetUrl()

end event


Start of PowerBuilder Binary Data Section : Do NOT Edit
0Au_tabpg_browse.bin 
2900000a00e011cfd0e11ab1a1000000000000000000000000000000000003003e0009fffe000000060000000000000000000000010000000100000000000010000000000200000001fffffffe0000000000000000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdfffffffefffffffefffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff006f00520074006f004500200074006e00790072000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050016ffffffffffffffff00000001000000000000000000000000000000000000000000000000000000000b8f0c8001ca73cb00000003000001800000000000500003004f0042005800430054005300450052004d0041000000000000000000000000000000000000000000000000000000000000000000000000000000000102001affffffff00000002ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000009c00000000004200500043004f00530058004f00540041005200450047000000000000000000000000000000000000000000000000000000000000000000000000000000000001001affffffffffffffff000000038856f96111d0340ac0006ba9a205d74f000000000b8f0c8001ca73cb0b8f0c8001ca73cb000000000000000000000000004f00430054004e004e00450053005400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001020012ffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000030000009c000000000000000100000002fffffffe0000000400000005fffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
2Cffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000004c000035d9000022010000000000000000000000000000000000000000000000000000004c0000000000000000000000010057d0e011cf3573000869ae62122e2b00000008000000000000004c0002140100000000000000c0460000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004c000035d9000022010000000000000000000000000000000000000000000000000000004c0000000000000000000000010057d0e011cf3573000869ae62122e2b00000008000000000000004c0002140100000000000000c0460000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1Au_tabpg_browse.bin 
End of PowerBuilder Binary Data Section : No Source Expected After This Point
